name: Allure Report

env:
    SOLUTION_FILE: Allure.Examples.NUnit3.sln
    BUILD_CONFIGURATION: Debug
    PROJECT_NAME: Allure.Examples.NUnit3

on:
  push:
    branches-ignore:
      - '!main'

jobs:
    autotests:
        name: Run tests and generate Allure Report
        runs-on: windows-latest
        steps:
            - run: |
                $VsInstallPath = vswhere.exe -latest -property installationPath
                $LaunchDevToolPath = Join-Path $VsInstallPath 'Common7\Tools\Launch-VsDevShell.ps1'
                If (Test-Path -PathType 'Leaf' $LaunchDevToolPath)
                {
                    & $LaunchDevToolPath
                    Get-Command "sn.exe"
                }
